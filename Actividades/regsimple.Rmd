---
title: "Regresión Lineal Simple"
author: "Semillero R - FacCA"
date: "10 de agosto de 2019"
output:
  ioslides_presentation:
    css: estilo.css
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE,
                      fig.align = "center")
```

# Problema

## Descripción del problema

**Gasto militar vs Gasto en Educación:** previamente se evidenció a través de gráficos de dispersión y métricas de correlación, la relación negativa entre la inversión militar y la inversión en educación. Se sugiere construir un modelo de regresión lineal simple que permita determinar el cambio en $y$ dado $x$, es decir, que el modelo permitirá establecer por cada unidad que aumenta el gasto militar, cuánto disminuye el gasto en educación.
El modelo se puede expresar de la siguiente manera:

- Modelo matemático: $y = mx + b$
- Modelo estadístico 1: $y = \beta_0\ +\ \beta_1X$
- Modelo estadístico 2: $\hat{y_i} = \hat{\beta_0}\ + \hat{\beta_1}X_i\ + \epsilon_i$

# Gasto Militar vs Gasto Educación

## Base de datos

```{r}
# Lectura de datos
datos <- read.csv("Datos_Continentes.csv",
                  encoding = "UTF-8")

# Omitiendo NAs
library(dplyr)
df_reg <- datos %>% 
  filter(!is.na(gasto_militar17)) %>% 
  filter(!is.na(gasto_edu16)) %>% 
  select(pais, gasto_militar17, gasto_edu16) %>% 
  filter(gasto_militar17 <= 10)
df_reg
```

## Histograma gasto militar

```{r}
hist(df_reg$gasto_militar17,
     xlab = "Gasto militar (% del PIB)",
     ylab = "Frecuencia",
     col = "forestgreen",
     main = "Distribución del G. Militar")
abline(v = mean(df_reg$gasto_militar17), col = "red",
       lwd = 2)
```

## Histograma gasto educación

```{r}
hist(df_reg$gasto_edu16,
     xlab = "Gasto en educación (% del PIB)",
     ylab = "Frecuencia",
     col = "forestgreen",
     main = "Distribución del G. en Educación")
abline(v = mean(df_reg$gasto_edu16), col = "red",
       lwd = 2)
```

## Dispersión 1 (valor atípico)

```{r}
plot(x = datos$gasto_militar17,
     y = datos$gasto_edu16,
     xlab = "Gasto Miliar",
     ylab = "Gasto en Educación",
     main = "Relación del G. Militar vs G. Educación\n% del PIB",
     pch = 19)
abline(lm(datos$gasto_edu16 ~ datos$gasto_militar17),
       col = "red", lwd = 2)
```

## Dispersión 2 (sin valor atípico)

```{r}
plot(x = df_reg$gasto_militar17,
     y = df_reg$gasto_edu16,
     xlab = "Gasto Miliar",
     ylab = "Gasto en Educación",
     main = "Relación del G. Militar vs G. Educación\n% del PIB",
     pch = 19)
abline(lm(df_reg$gasto_edu16 ~ df_reg$gasto_militar17),
       col = "red", lwd = 2)
```

## Coeficientes de correlación

- **Correlación de Pearson con dato atípico:**

```{r}
cor(datos$gasto_edu16, datos$gasto_militar17,
    use = "pairwise.complete.obs")
```

- **Correlación de Pearson sin dato atípico:**

```{r}
cor(df_reg$gasto_edu16, df_reg$gasto_militar17)
```

## Test de hipótesis con valor atípico

$$H_0: \rho = 0\\H_1: \rho \neq 0$$

```{r}
cor.test(datos$gasto_militar17, datos$gasto_edu16)
```

**Conclusión:** como el valor p (0.9656) es mayor que el nivel de significancia $\alpha = 0.05$, no existe evidencia para rechazar la hipótesis nula.

## Test de hipótesis sin valor atípico

$$H_0: \rho = 0\\H_1: \rho \neq 0$$

```{r}
cor.test(df_reg$gasto_militar17, df_reg$gasto_edu16)
```

**Conclusión:** como el valor p (0.1199) es mayor que el nivel de significancia $\alpha = 0.05$, no existe evidencia para rechazar la hipótesis nula.

## Modelo tentativo

El modelo tentativo se puede expresar de la siguiente manera:

$$G.Edu = \beta_0\ +\ \beta_1G.Militar$$

## Regresión Lineal Simple en R

```{r}
mod1 <- lm(df_reg$gasto_edu16 ~ df_reg$gasto_militar17)
summary(mod1)
```

## Normalidad de residuales

## Homocedasticidad de residuales

## Independencia de residuales

## Modelo final

## Intervalos de confianza

## Predicciones

## Conclusiones






